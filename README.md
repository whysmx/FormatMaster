# FormatMaster - Word格式还原工具

一个简单易用的Word文档格式还原Web应用，通过浏览器即可快速还原文档格式。

## ✨ 主要特性

- 🌐 **网页操作** - 无需安装，打开浏览器即可使用
- ⚡ **快速处理** - 单文档处理时间 < 2秒
- 🎯 **格式精确** - 100%还原标准文档的格式定义
- 📑 **多模板支持** - 管理多个标准格式模板，一键切换
- 💾 **批量处理** - 支持批量处理多个文档
- 🛡️ **内容安全** - 只修改格式，不改变文档内容
- 📊 **格式验证** - 显示转换后的格式匹配度

## 🚀 快速开始

### 本地使用

1. **安装依赖**

```bash
cd web
pip install -r requirements.txt
```

2. **启动服务**

```bash
python main.py
```

3. **访问应用**

打开浏览器访问：http://localhost:8002

### 在线体验

访问在线演示页面：[https://your-domain.com](https://your-domain.com)

## 📖 使用说明

### 一、文档转换

#### 步骤1：选择标准格式模板

- 在左侧模板列表中选择一个标准格式文档
- 首次使用需要先上传标准格式模板（见"模板管理"）
- 支持多个模板，点击即可切换

#### 步骤2：上传待处理文档

- 点击上传区域选择文件
- 或直接拖拽文件到上传区域
- 支持的文件格式：.docx

#### 步骤3：开始转换

- 点击"开始转换"按钮
- 等待处理完成（通常1-2秒）
- 查看格式相似度（理想情况下应达到100%）

#### 步骤4：下载结果

- 点击"下载"按钮获取处理后的文档
- 文件下载后会自动删除，节省存储空间

### 二、模板管理

#### 上传新模板

1. 点击顶部导航的"模板管理"
2. 点击"上传新模板"按钮
3. 选择标准格式文档（.docx文件）
4. 输入模板名称（如：标准合同格式、正式公文格式等）
5. 点击"确认上传"

#### 设为默认模板

- 在模板列表中找到需要设置的模板
- 点击"设为默认"按钮
- 默认模板会自动选中，方便快速使用

#### 删除模板

- 点击模板右侧的"删除"按钮
- 确认删除操作
- 注意：删除后无法恢复

### 三、查看历史记录

- 点击顶部导航的"历史记录"
- 查看所有转换操作记录
- 支持按日期筛选

## 📋 格式还原范围

### 支持的格式类型

✅ **字体样式**
- 字体名称、字号、颜色
- 加粗、斜体、下划线
- 删除线、上标、下标

✅ **段落样式**
- 对齐方式（左对齐、居中、右对齐、两端对齐）
- 行距（单倍、1.5倍、2倍、固定值等）
- 段前段后间距
- 首行缩进、悬挂缩进

✅ **标题样式**
- 标题 1-9 级样式
- 自动编号
- 层级结构

✅ **编号和项目符号**
- 多级编号
- 项目符号
- 自定义编号格式

✅ **表格样式**
- 表格边框
- 单元格背景色
- 表格对齐方式

✅ **页面设置**
- 纸张大小（A4、A3、16开等）
- 页边距（上下左右）
- 页面方向（横向、纵向）

✅ **其他元素**
- 页眉页脚（保留内容）
- 图片、图表、超链接
- 批注、脚注、尾注

### 不修改的内容

🔒 **文档内容** - 完全保留原文文字
🔒 **图片图表** - 保留所有图表
🔒 **数据表格** - 保留表格数据
🔒 **批注修订** - 保留批注和修订记录

## 🛠️ 技术说明

### 工作原理

1. **提取格式** - 从标准模板文档中提取格式定义
2. **保留内容** - 保留待处理文档的所有内容
3. **应用格式** - 将标准格式应用到新文档
4. **验证结果** - 计算格式相似度，确保准确性

### 技术栈

- **后端**: Python + FastAPI
- **前端**: HTML5 + CSS3 + JavaScript
- **文档处理**: lxml + python-docx
- **部署**: 支持本地运行和云端部署

## 📊 性能指标

| 指标 | 数值 |
|------|------|
| 处理速度 | < 2秒/文档 |
| 支持格式 | .docx |
| 并发用户 | 10人同时使用 |
| 文件大小 | 无限制 |
| 格式准确率 | 100% |

## 🔒 安全与隐私

- ✅ **文件隔离** - 每个用户的文件相互隔离
- ✅ **临时存储** - 文件下载后自动删除
- ✅ **本地处理** - 可在本地运行，无需上传到云端
- ✅ **格式验证** - 仅处理.docx格式文件
- ✅ **无数据收集** - 不收集任何用户数据

## 💡 使用场景

### 适合使用FormatMaster的场景

📄 **合同文档** - 统一合同格式，保持专业形象
📋 **报告文档** - 统一报告格式，提高文档质量
📝 **公文格式** - 快速应用公文标准格式
📚 **学术论文** - 统一论文格式要求
📧 **商务文档** - 统一商务文档样式

### 典型工作流程

1. 准备一个标准格式的文档作为模板
2. 将模板上传到FormatMaster
3. 批量处理需要统一格式的文档
4. 下载处理好的文档

## 🐛 常见问题

### Q: 转换后格式没有变化？

**A:** 请检查：
1. 是否选择了正确的标准格式模板
2. 待处理文档是否为.docx格式
3. 浏览器控制台是否有错误信息

### Q: 格式相似度不是100%？

**A:** 可能原因：
1. 标准模板和待处理文档的内容结构差异较大
2. 文档中使用了自定义样式而非标准样式
3. 可以尝试手动调整后重新转换

### Q: 无法上传文件？

**A:** 请确认：
1. 文件格式为.docx（不支持.doc格式）
2. 文件没有损坏
3. 文件大小在服务器允许范围内

### Q: 下载失败？

**A:** 文件可能已过期被自动删除，请重新转换。

## 📝 更新日志

### v1.0.0 (2025-01-12)
- ✨ 首次发布
- 🌐 支持Web界面操作
- 📑 支持多模板管理
- 📊 支持格式相似度显示
- 📜 支持历史记录查看

## 📄 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📧 联系方式

- GitHub: https://github.com/whysmx/FormatMaster
- Issues: https://github.com/whysmx/FormatMaster/issues

---

**让Word文档格式还原变得简单！** 📄✨
